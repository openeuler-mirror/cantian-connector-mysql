--disable_warnings
drop table if exists t1;
--enable_warnings

CREATE TABLE IF NOT EXISTS t1 (
  a INT AUTO_INCREMENT PRIMARY KEY,
  b INT NOT NULL,
  c VARCHAR(20) DEFAULT NULL,
  d DECIMAL NOT NULL
);

CREATE INDEX idx_b ON t1(b);
CREATE INDEX idx_c ON t1(c);
CREATE INDEX idx_d ON t1(d);
CREATE INDEX idx_bcd ON t1(b, c, d);

DROP PROCEDURE IF EXISTS insert_data_to_t1;
DELIMITER //;
CREATE PROCEDURE insert_data_to_t1()
BEGIN
  DECLARE i INT DEFAULT 0;
  WHILE i < 500 DO
    INSERT INTO t1 (b, c, d) VALUES (i, NULL, i + 2);
    INSERT INTO t1 (b, c, d) VALUES (i + 1, i + 2, i + 3);
    INSERT INTO t1 (b, c, d) VALUES (i + 2, i + 3, i + 4);
    INSERT INTO t1 (b, c, d) VALUES (111, NULL, i);
    INSERT INTO t1 (b, c, d) VALUES (121, 121, i);
    INSERT INTO t1 (b, c, d) VALUES (131, i + 4, i + 5);
    SET i = i + 1;
  END WHILE;
END //
DELIMITER ;//
CALL insert_data_to_t1();

DROP PROCEDURE IF EXISTS insert_data_to_t1;

ANALYZE TABLE t1;

SELECT COUNT(1) FROM t1 WHERE b < 500;
SELECT COUNT(1) FROM t1 WHERE b >= 200;
SELECT COUNT(1) FROM t1 WHERE b >= 200 AND c < 500;
SELECT COUNT(1) FROM t1 WHERE c < '700';
SELECT COUNT(1) FROM t1 WHERE c <= '200';
SELECT COUNT(1) FROM t1 WHERE c >= '100';
SELECT COUNT(1) FROM t1 WHERE c >= '100' AND c <= '200';
SELECT COUNT(1) FROM t1 WHERE c IS NULL;
SELECT COUNT(1) FROM t1 WHERE c IS NOT NULL;
SELECT COUNT(1) FROM t1 WHERE d >= 100.00;
SELECT COUNT(1) FROM t1 WHERE d < 400.00;
SELECT COUNT(1) FROM t1 WHERE d >= 100.00 AND d < 400.00;

--disable_warnings
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_b) WHERE b < 500;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_b) WHERE b >= 200;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_b) WHERE b >= 200 AND c < 500;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_c) WHERE c < '700';
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_c) WHERE c <= '200';
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_c) WHERE c >= '100';
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_c) WHERE c >= '100' AND c <= '200';
EXPLAIN SELECT * FROM t1 WHERE c IS NULL;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_c) WHERE c IS NOT NULL;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_d) WHERE d >= 100.00;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_d) WHERE d < 400.00;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_d) WHERE d >= 100.00 AND d < 400.00;
--enable_warnings

SELECT COUNT(1) FROM t1 WHERE b = 111 AND c IS NULL AND d < 100;
SELECT COUNT(1) FROM t1 WHERE b = 121 AND c = '121' AND d >= 10;
SELECT COUNT(1) FROM t1 WHERE b < 300 AND c > '300';
SELECT COUNT(1) FROM t1 WHERE b = 121 AND c IS NULL AND  d >= 100 AND d < 400;
SELECT COUNT(1) FROM t1 WHERE b = 121 AND c IS NOT NULL and d > 200;
SELECT COUNT(1) FROM t1 WHERE b = 121 AND d >= 100.00;
SELECT COUNT(1) FROM t1 WHERE b = 131 AND c >= '100' AND  c <= '400';

--disable_warnings
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_bcd) WHERE b = 111 AND c IS NULL AND d < 100;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_bcd) WHERE b = 121 AND c = '121' AND d >= 100;
EXPLAIN SELECT * FROM t1 WHERE b < 300 AND c > '300';
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_bcd) WHERE b = 121 AND c IS NULL AND d >= 100 AND d < 400;
EXPLAIN SELECT * FROM t1 WHERE b = 121 AND c IS NOT NULL and d > 200;
EXPLAIN SELECT * FROM t1 WHERE b = 121 AND d >= 100.00;
EXPLAIN SELECT * FROM t1 FORCE INDEX (idx_bcd) WHERE b = 131 AND c >= '100' AND  c <= '400';
--enable_warnings

drop table t1;